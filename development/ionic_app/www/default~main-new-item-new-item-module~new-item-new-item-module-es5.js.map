{"version":3,"sources":["./src/app/tabs/main/new-item/new-item.page.html","./src/app/tabs/main/new-item/new-item-routing.module.ts","./src/app/tabs/main/new-item/new-item.module.ts","./src/app/tabs/main/new-item/new-item.page.scss","./src/app/tabs/main/new-item/new-item.page.ts"],"names":[],"mappings":"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","file":"default~main-new-item-new-item-module~new-item-new-item-module-es5.js","sourcesContent":["module.exports = \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button defaultHRef=\\\"/tabs\\\"></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>Connected device</ion-title>\\n    <ion-buttons slot=\\\"primary\\\">\\n      <ion-button [routerLink]=\\\"['/tabs/tab1/info']\\\"\\n        ><ion-icon name=\\\"information-circle\\\" slot=\\\"icon-only\\\"></ion-icon\\n      ></ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content fullscreen>\\n  <ion-list style=\\\"margin-right: 15px;\\\">\\n    <ion-list-header>\\n      <p style=\\\"font-size: 10px;\\\">CURRENTLY CONNECTED</p>\\n    </ion-list-header>\\n\\n    <ion-item *ngFor=\\\"let device of currentlyConnected\\\">\\n      <ion-label style=\\\"margin-left: 10px;\\\">\\n        <h2>{{device.name}}</h2>\\n        <h3>{{device.location}}</h3>\\n      </ion-label>\\n      <ion-icon name=\\\"cloud-done\\\" (click)=\\\"unpair()\\\"\\n      style=\\\"margin: 0 10px 0 10px; color: greenyellow; font-size: 40px; cursor: pointer\\\"></ion-icon>\\n    </ion-item> \\n\\n    <ion-item *ngIf=\\\"currentlyConnected.length == 0\\\">\\n      <ion-label style=\\\"margin-left: 10px;\\\">\\n        <p> No device is currently connected </p>\\n      </ion-label>\\n      <ion-icon name=\\\"pause\\\"></ion-icon>\\n    </ion-item>\\n  </ion-list>\\n\\n  <ion-item style=\\\"margin-left: 15px; margin-right: 15px;\\\">\\n    <ion-label position=\\\"floating\\\">Pair <span style=\\\"font-size: 12px;\\\">(serial number)</span></ion-label>\\n    <ion-input (keyup.enter)=\\\"pair()\\\" [(ngModel)]=\\\"inputSerialNumber\\\"></ion-input>\\n  </ion-item>\\n\\n  <ion-list style=\\\"margin-right: 15px;\\\" *ngIf=\\\"previouslyConnected.length > 0\\\">\\n    <ion-list-header>\\n      <p style=\\\"font-size: 10px;\\\">PREVIOUSLY CONNECTED DEVICES </p>\\n    </ion-list-header>\\n\\n    <ion-item *ngFor=\\\"let device of previouslyConnected\\\">\\n      <ion-label style=\\\"margin-left: 10px;\\\">\\n        <h2>{{device.name}}</h2>\\n        <h3>{{device.location}}</h3>\\n      </ion-label>\\n      <ion-icon name=\\\"cloud-outline\\\" style=\\\"margin: 0 10px 0 10px; color: gray; font-size: 40px;\\\"></ion-icon>\\n    </ion-item> \\n    \\n  </ion-list>\\n</ion-content>\"","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { NewItemPage } from './new-item.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: NewItemPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class NewItemPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { NewItemPageRoutingModule } from './new-item-routing.module';\n\nimport { NewItemPage } from './new-item.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    NewItemPageRoutingModule\n  ],\n  declarations: [NewItemPage]\n})\nexport class NewItemPageModule {}\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3RhYnMvbWFpbi9uZXctaXRlbS9uZXctaXRlbS5wYWdlLnNjc3MifQ== */\"","import { Component, OnInit } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { ToastController } from '@ionic/angular';\nimport { Router } from '@angular/router';\nimport { BackendServerService } from '../../../services/backend-server.service';\nimport { LocalStorageService } from 'src/app/services/local-storage.service';\nimport { Network } from '@ionic-native/network/ngx';\nimport { PopoverController } from '@ionic/angular';\nimport { PairNewComponent } from '../pair-new/pair-new.component';\n\nexport interface Order {\n  id: number;\n  table: string;\n  details: string;\n  status: string;\n  time: number;\n  type: string;\n}\n\n@Component({\n  selector: 'app-new-item',\n  templateUrl: './new-item.page.html',\n  styleUrls: ['./new-item.page.scss'],\n})\nexport class NewItemPage implements OnInit {\n\n  showProgressBar = false;\n  URI = this.backend.URI;\n  ws = this.backend.ws;\n  canvasItem: Order = {\n    id: -1,\n    table: '',\n    details: '',\n    status: 'recorded',\n    time: null,\n    type: ''\n  };\n\n  currentlyConnected = [{name: 'Flotilla', location: '', serialNumber: 1}];\n  previouslyConnected = [];\n  inputSerialNumber = 0;\n\n  constructor(\n    private http: HttpClient,\n    private router: Router,\n    private toast: ToastController,\n    private backend: BackendServerService,\n    private localStorage: LocalStorageService,\n    private network: Network,\n    public popoverController: PopoverController) {\n  }\n\n  ngOnInit() {\n    this.localStorage.at('previouslyConnected').then((resp) => {\n      if(resp != null) {\n        this.previouslyConnected = resp;\n      }\n    });\n    this.localStorage.at('currentlyConnected').then((resp) => {\n      if(resp != null) {\n        this.currentlyConnected = resp;\n      }\n    });\n  }\n\n  onCreate() {\n    console.log('main.new-item: onCreate');\n    this.showProgressBar = true;\n\n    if (this.network.type === this.network.Connection.NONE) {\n      this.localStorage.at('offline').then((offlineOrders) => {\n        let foo = offlineOrders as Order[];\n        if (foo == null) {\n          foo = [];\n        } else {\n          foo.push(this.canvasItem);\n        }\n        this.localStorage.append('offline', foo);\n      });\n      this.presentOkToast('Stored offline.');\n      this.router.navigate(['/tabs/tab1']);\n    } else {\n      setTimeout(() => {\n        const pBook = this.http.post(this.URI + '/order', this.canvasItem).toPromise();\n        pBook.then((resp) => {\n          this.presentOkToast('Succesfully created.');\n          this.router.navigate(['/tabs/tab1']);\n        })\n        .catch((err) => {\n          this.presentOkToast('Error while adding.');\n          this.router.navigate(['/tabs/tab1']);\n        });\n      }, 1000);\n    }\n  }\n\n  presentOkToast(myMessage: string) {\n    this.toast.create({\n      message: myMessage,\n      duration: 2000,\n      buttons: [\n        {\n          text: 'Ok',\n          role: 'cancel'\n        }\n      ]\n    }).then(t => { t.present(); });\n  }\n\n  unpair() {\n    this.backend.ws.send(JSON.stringify({emit: false})).subscribe(\n      (msg) => {\n          console.log('next', msg.data);\n      },\n      (msg) => {\n          console.log('error', msg);\n      },\n      () => {\n          console.log('complete');\n          const toUnpair = this.currentlyConnected[0];\n          this.currentlyConnected.splice(0, 1);\n          this.previouslyConnected.push(toUnpair);\n          this.localStorage.append('currentlyConnected', this.currentlyConnected);\n          this.localStorage.append('previouslyConnected', this.previouslyConnected);\n          this.localStorage.append('paired', [false]);\n      }\n    );\n  }\n\n  pair() {\n    console.log(this.inputSerialNumber);\n    if (this.currentlyConnected.length > 0 && this.inputSerialNumber == this.currentlyConnected[0].serialNumber) {\n      this.presentOkToast('Device already paired');\n    } else if (this.inputSerialNumber != null) {\n      this.backend.ws.send(JSON.stringify({emit: true})).subscribe(\n        (msg) => {\n          console.log('next', msg.data);\n        },\n        (msg) => {\n          console.log('error', msg);\n        },\n        () => {\n          console.log('complete');\n          let index = -1;\n          for (const device of this.previouslyConnected) {\n            if (device.serialNumber == this.inputSerialNumber) {\n              index = this.previouslyConnected.indexOf(device);\n            }\n          }\n          if (index >= 0) {\n            const toPair = this.previouslyConnected[index];\n            this.previouslyConnected.splice(index, 1);\n            this.currentlyConnected.push(toPair);\n          } else {\n            this.currentlyConnected.push({name: 'Flotilla', location: '', serialNumber: this.inputSerialNumber});\n          }\n          this.localStorage.append('currentlyConnected', this.currentlyConnected);\n          this.localStorage.append('previouslyConnected', this.previouslyConnected);\n          this.localStorage.append('paired', [true]);\n        }\n      );\n    }\n  }\n}\n"],"sourceRoot":""}